"use strict";function ___$insertStyle(e){if(e&&"undefined"!=typeof window){const t=document.createElement("style");return t.setAttribute("type","text/css"),t.innerHTML=e,document.head.appendChild(t),e}}Object.defineProperty(exports,"__esModule",{value:!0});var utils=require("./utils-941b7ac2.js"),defineProperty=require("./defineProperty-f32bb15f.js"),index=require("./index-3287f8ed.js"),ignoreStatuses=["OK","NO_ROWS"],crudAfterMiddleware=function(e){return function(d){return function(e){if(/.*_FAILURE$/gi.test(e.type)&&401!==e.meta.status)return d({type:"ADD_NOTIFICATION",notification:{id:parseInt(Math.random().toString().split(".")[1],10),duration:7e3,message:"Something went wrong. Try again later.",type:"NOTIFICATION_TYPE_ERROR",canDismiss:!0}}),Promise.reject(d(e));if(/.*_SUCCESS$/gi.test(e.type)){var t=index.lodash_clonedeep(e);if(t.payload.status&&t.payload.status.length||(t.payload.status="EMPTY_STATUS_FROM_BACKEND"),"object"!==defineProperty._typeof(t.payload.payload)&&(t.payload.payload={item:{},items:[]}),"object"!==defineProperty._typeof(t.payload._meta)&&(t.payload._meta={}),t.meta&&t.meta.validStatuses&&t.payload){var r=t.payload,i=t.meta,n=i.validStatuses,n=void 0===n?[]:n,i=i.errorMessagesByStatus,i=void 0===i?{}:i,r=(void 0===r?{status:"INTERNAL_ERROR"}:r).status;if(ignoreStatuses.indexOf(r)<0&&n.indexOf(r)<0){r=i[r]||"Something went wrong. Try again later.";return d({type:"ADD_NOTIFICATION",notification:{id:parseInt(Math.random().toString().split(".")[1],10),duration:7e3,message:r,type:"NOTIFICATION_TYPE_ERROR",canDismiss:!0}}),Promise.reject(d(e))}}return d(t)}return d(e)}}},RSAA="@@redux-api-middleware/RSAA",listRegexp=/^LIST_(.*)_REQUEST$/,crudBeforeMiddleware=function(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"dr-pa-token";return function(i){return function(r){return function(e){if(e.isCrud){var t=index.lodash_clonedeep(e);if(delete t.isCrud,listRegexp.test(e[RSAA].types[0])){if(i.getState()[e.reducer].isLoading)return!1;delete t.reducer}return t[RSAA].body&&"application/json"===t[RSAA].headers["Content-Type"]&&"string"!=typeof t[RSAA].body&&(t[RSAA].body=JSON.stringify(t[RSAA].body)),e.needToken&&(t[RSAA].headers.Authorization="Bearer ".concat(utils.getCookie(n)),delete t.needToken),r(t)}return r(e)}}}},initialState={isLoading:{}},crudReducer=function(){var e,t,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:initialState,i=1<arguments.length?arguments[1]:void 0;return i.type.includes("CRUD_ACTION_REQUEST")&&(e=i.type.split("_")[0],(t=index.lodash_clonedeep(r)).isLoading[e]=!0),(i.type.includes("CRUD_ACTION_SUCCESS")||i.type.includes("CRUD_ACTION_FAILURE"))&&(i=i.type.split("_")[0],(t=index.lodash_clonedeep(r)).isLoading[i]=!1),t||r};exports.CRUD_ACTION_FAILURE=utils.CRUD_ACTION_FAILURE,exports.CRUD_ACTION_REQUEST=utils.CRUD_ACTION_REQUEST,exports.CRUD_ACTION_SUCCESS=utils.CRUD_ACTION_SUCCESS,exports.crud=utils.crud,exports.crudAfterMiddleware=crudAfterMiddleware,exports.crudBeforeMiddleware=crudBeforeMiddleware,exports.crudReducer=crudReducer;
